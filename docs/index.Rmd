----
title: "Prison Inequality Evaluations"
author: "Jesus Vargas"
date: '2022-11-01'
output: 
  html_document: 
    fig_width: 15
    fig_height: 15
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, message = F, warning = F)
```


```{r echo=FALSE, eval=TRUE, message=FALSE}
source("a4-helpers.R")
source("analysis.R")
```


```{r}
# Load packages
library(tidyverse)
library(RColorBrewer)
library(reshape2)
library(lattice)
library(readxl)

# Read data
df <- read_excel("incarceration_trends.xlsx")

```

## Abstract 
[TODO: Include a short abstract (about 50 words)]


## Introduction 
[TODO]

## Data Summary 


## Growth of the US Prison Population
The figure below represents average population of Blacks in prisons. It is observed that there has been a steady increase in the numbers.

```{r}
df %>% group_by(year) %>% 
  summarise(Black = mean(black_prison_pop, na.rm = T),
            White = mean(white_prison_pop, na.rm = T)) %>% 
  ggplot(aes(x = year, y = Black)) +
  geom_line() + 
  labs(x = "Year", y = "Average Black population")
```


## Growth of Prison Population by state

The figure below represents how average black population in prisons has developed in states. Some states are observed to have no prisoners whereas most of the states have prisoners. Generally, the population in prisons is observed to be increasing in most states whith some notable exceptions like NY, and IN.

```{r}

df %>% group_by(year, state) %>% 
  summarise(Black = mean(black_prison_pop, na.rm = T),
            White = mean(white_prison_pop, na.rm = T)) %>% 
  ggplot(aes(x = year, y = Black)) +
  geom_line() + facet_wrap(~state, scales = "free_y") +
  labs(x = "Year", y = "Average Black population")
```


## Potential patterns of inequality

To determine potential patterns of inequality, average population in prisons for white and Black individuals are compared in the figure below. 

```{r}

df %>% group_by(year) %>% 
  summarise(Black = mean(black_prison_pop, na.rm = T),
            White = mean(white_prison_pop, na.rm = T)) %>% 
  reshape2::melt(id = c("year")) %>% 
  ggplot(aes(x = year, y = value, color = variable)) +
  geom_line() + labs(x = "Year", y = "Average population")
```


## Geographical patterns of inequality


```{r}

df %>% group_by(year, state) %>% 
  summarise(Black = mean(black_prison_pop, na.rm = T),
            White = mean(white_prison_pop, na.rm = T)) %>% 
  reshape2::melt(id = c("year", "state")) %>% 
  ggplot(aes(x = year, y = value, color = variable)) +
  geom_line() + facet_wrap(~state, scales = "free_y") +
  labs(x = "Year", y = "Average population")
```





